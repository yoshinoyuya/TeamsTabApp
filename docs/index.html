<!DOCTYPE html>
<html lang="jp">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://statics.teams.microsoft.com/sdk/v1.5.2/js/MicrosoftTeams.min.js"
    crossorigin="anonymous"></script>
    <title>Document</title>
</head>
<body>
    <div>
        <a href="privacy.html">pruvacy</a><br>
        <a href="termsofuse.html">termsofuse</a>
    </div>
    <input type="text" id="url">
    <button id="btn">遷移</button>
    <div id="log"></div>
    <script>
        document.getElementById("btn").onclick = function(){
            var url = document.getElementById("url").value
            if(url != ""){
                window.location.href = url
            }
        }
        let logDev = document.getElementById("log");
        let displayAry = (ary) => {
            for (key in ary) {
                if (typeof (ary[key]) == "object") {
                    displayAry(ary[key])
                } else {
                    logDev.innerHTML = logDev.innerHTML +`key : ${key}, value : ${ary[key]}<br>`
                    console.log(`key : ${key}, value : ${ary[key]}`)
                }
            }
        }
        microsoftTeams.initialize();

        //DOM がロードされてから
        document.addEventListener('DOMContentLoaded', () => {
            //Microsoft Teams のユーザーコンテキストを取得
            microsoftTeams.getContext((context) => {
                displayAry(context);
            });
        });
        // const options = {
        //     authProvider,
        // };
        // try {
        //     const client = Client.init(options);

        //     let conversationMember = await client.api('/teams/ece6f0a1-7ca4-498b-be79-edf6c8fc4d82/members/ZWUwZjVhZTItOGJjNi00YWU1LTg0NjYtN2RhZWViYmZhMDYyIyM3Mzc2MWYwNi0yYWM5LTQ2OWMtOWYxMC0yNzlhOGNjMjY3Zjk=')
        //         .get();
        //     document.getElementById("log").append(conversationMember);
        // } catch (error) {
        //     document.getElementById("log").append(error);
        // }

    </script>
</body>
</html>
